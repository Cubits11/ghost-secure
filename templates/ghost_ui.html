<!-- ghost_ui.html -->
<h1>Ghost UI Rendered Successfully</h1>
{% extends "base.html" %}
{% block title %}Ghost Secure UI{% endblock %}

{% block content %}
  <div id="lockdownBanner" class="lockdown-banner">ğŸ”’ System is in lockdown.</div>

  <main>
    <h1>Ghost Secure Testing UI</h1>

    <div class="button-group">
      <button id="toggleLockBtn">ğŸ” Toggle Lockdown</button>
      <button id="pullPromptBtn">ğŸ§  Pull Prompt</button>
      <button id="statusCheckBtn">ğŸ“¡ Check System Status</button>
    </div>

    <div id="promptDisplay" class="prompt-box">Prompt will appear here...</div>
    <div id="statusDisplay"></div>
  </main>
{% endblock %}

{% block scripts %}
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    const updateLockdownUI = (state) => {
      $("#lockdownBanner").toggle(state);
      $("#toggleLockBtn").text(state ? "ğŸ”“ Unlock System" : "ğŸ”’ Lock System");
    };

    $("#toggleLockBtn").click(() => {
      $.post("/toggle_lockdown", {}, function(data) {
        updateLockdownUI(data.enabled);
        alert(data.message);
      });
    });

    $("#pullPromptBtn").click(() => {
      $.get("/get_prompt", function(data) {
        $("#promptDisplay").text(data.prompt?.question || "No prompt received.");
      });
    });

    $("#statusCheckBtn").click(() => {
      $.get("/status", function(data) {
        $("#statusDisplay").html(`
          <p>ğŸ” Status: ${data.status}</p>
          <p>ğŸ”’ Lockdown: ${data.lockdown}</p>
          <p>â± Timestamp: ${data.timestamp}</p>
        `);
        updateLockdownUI(data.lockdown);
      });
    });

    // Initial check
    $(document).ready(() => {
      $("#statusCheckBtn").click();
    });
  </script>
{% endblock %}